{% extends 'base.html.twig' %}

{% block title %}Nouvelle réservation
{% endblock %}

{% block body %}
	{{ render(controller('App\\Controller\\NavbarController::etablissementAction' )) }}

	<div class="container-fluid">
		<div class="row my-5">
			{% if (is_granted('ROLE_USER')) or (is_granted('ROLE_GERANT'))  or (is_granted('ROLE_ADMIN')) %}
				<div class="col-sm-8 offset-sm-2">
					{{ form_start(form) }}
Vous avez sélectionné :
					{{ form_row(form.etaid) }}
					{{ form_row(form.suiid) }}

Veuillez choisir vos dates de séjour :
					{{ form_row(form.startDate) }}
					{{ form_row(form.endDate) }}
					<span class="check_ok"></span>
					<span class="check_false"></span>
					<button id="hide" class="btn btn-primary">{{ button_label|default('Réserver') }}</button>
					{{ form_end(form) }}
				</div>
			{%  else  %}
				<div class="col-sm-8 offset-sm-2">
					<h3 class="text-center">Afin de pouvoir réserver, vous devez tout d'abord vous connecter ou créer un compte</h3>
					<div class="d-flex">
						<a class="btn btn-outline-secondary mx-auto" href="/login" role="button">Me connecter</a>
					</div>
				</div>
			{% endif %}
		</div>
	</div>

	{{ render(controller('App\\Controller\\FooterController::etablissementAction' )) }}
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bs5-lightbox@1.8.0/dist/index.bundle.min.js"></script>
	<script>window.onload = () => {
		let etaid = document.querySelector(#resa_form_etaid);
		etaid.addEventListener("change", function (){
			let form = this.closest("form");
			let data = this.name + "=" + this.value;

			fetch(form.action, {
				method: form.getAttribute("method"),
				body: data,
				header: {
					"Content-Type": "application/x-www-form-urlencoded; charset:utf-8"
				}
			})
			.then(response => response.text())
			.then(html => {
				let content = document.createElement("html");
				content.innerHTML = html;
				let nouveauSelect = content.querySelector(#resa_form_suiid)
			})
		});}</script>

{% endblock %}
